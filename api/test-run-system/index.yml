swagger: '2.0'
info:
  version: '1.0.0'
  title: Test Run System
schemes: [http]
consumes: [application/json, multipart/form-data]
produces: [application/json]
securityDefinitions:
  key:
    type: apiKey
    in: header
    name: Authorization

paths:
  # health
  /health:
    $ref: ./path/v1/health/health.yml
  
  # product
  /v1/product:
    $ref: ./path/v1/product/product.yml
  
  /v1/product/{product_id}:
    $ref: ./path/v1/product/product_id.yml

definitions:
  principal:
    type: object
    properties:
      email:
        type: string
      user_id:
        type: number
        format: uint64
      expired_at:
        type: string

  product:
    allOf:
      - $ref: "./definitions/common.yml#/definitions/ModelIdentifier"
      - $ref: "./definitions/common.yml#/definitions/ModelTrackTime"
      - $ref: "./definitions/common.yml#/definitions/ModelTrackBy"
      - $ref: "#/definitions/productData"

  productData:
    type: object
    properties: 
      name:
        type: string
        x-omitempty: false
      stock:
        type: number
        format: uint64
      version:
        type: number
        format: uint64
      expiry_date:
        type: string
        format: date-time

  productActivityHistory:
    allOf:
      - $ref: "./definitions/common.yml#/definitions/ModelIdentifier"
      - $ref: "#/definitions/productActivityHistoryData"

  productActivityHistoryData:
    type: object
    properties: 
      product:
        $ref: "#/definitions/product"
      product_id:
        type: number
        format: uint64
      note:
        type: string
      type:
        type: string
      created_at:
        type: string
        format: date-time
        x-omitempty: false
      created_by:
        type: string
        x-omitempty: false
